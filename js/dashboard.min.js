$(document).ready(function(){var t={init:function(){$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check",size:10,dropupAuto:!1})}};$(".mine_change_check").change(function(){toastr.info("Wait","Executing..."),$(this).is(":checked")?value=1:value=0,table=$(this).data("table"),id=$(this).val(),col=$(this).data("col"),$.post("/cp/change_check/",{table:table,id:id,value:value,col:col},function(t){try{if(response=JSON.parse(t),200!=response.status)throw toastr.error("Status: 500!!!"),new Error("status 500");toastr.success("Ok!!!")}catch(t){toastr.error("Error!!"),console.log(t)}})}),$(".mine_change_check_firebase").change(function(){toastr.info("Wait","Executing..."),$(this).is(":checked")?value=1:value=0,table=$(this).data("table"),id=$(this).val(),col=$(this).data("col"),$.post("/cp/change_check_firebase/",{table:table,id:id,value:value,col:col},function(t){try{if(response=JSON.parse(t),200!=response.status)throw toastr.error("Status: 500!!!"),new Error("status 500");toastr.success("Ok!!!")}catch(t){toastr.error("Error!!"),console.log(t)}})}),$(".mine_change_select").change(function(){table=$(this).data("table"),id=$(this).data("id"),value=$(this).find(":selected").val(),col=$(this).data("col"),$.post("/cp/change_select/",{table:table,id:id,value:value,col:col},function(t){try{if(response=JSON.parse(t),200!=response.status)throw new Error("status 500");toastr.success("Ok!!!")}catch(t){toastr.error("Error!!"),console.log(t)}})}),$(document).on("click","#delete_related_product",function(t){if(t.preventDefault(),confirm("Вы уверены что хотите удалить?")){var e=$(this),a=$(this).data("product"),r=$(this).data("related");$.post("/cp/products/delete_related_product/",{product_id:a,related_id:r},function(t){response=JSON.parse(t),console.log(response);try{if(200!=response.status)throw new Error("status 500");e.parents("tr").hide(300)}catch(t){console.log(t),alert("Во время удаления произошла ошибка")}})}}),$("#add_related_product").on("click",function(t){t.preventDefault();var e=$(this),a=$("#match").data("related"),r=$("#match").data("product"),s=$("#match").val();$.post("/cp/products/add_related_product/",{related_id:a,product_id:r},function(t){response=JSON.parse(t);try{if(200!=response.status)throw new Error("status 500");e.parents("table").append("<tr><td>"+s+'</td><td width="100"><button id="delete_related_product" data-product="'+r+'" data-related="'+a+'" class="btn red"><i class="fa fa-trash-o"></i> Удалить</button></td></tr>'),$("#match").val("")}catch(t){console.log(t),alert("Произошла ошибка")}})}),$("#match").on("keyup",function(){var t=$(this).val();""!=t?$.post("/cp/products/autocomplete/",{match:t},function(t){response=JSON.parse(t),console.log(response);try{if(200!=response.status)throw new Error("status 500");$(".search_result").empty(),$.each(response.result,function(t,e){$(".search_result").append('<a class="result_a" id="'+e.id+'" href="/"><span class="title">'+e.title+"</span></a><br>")}),$(".search_result").show()}catch(t){console.log(t),alert("Произошла ошибка")}}):$(".search_result").hide()}),$(document).on("click",".result_a",function(t){var e=$(this).attr("id"),a=$(this).find(".title").text();$("#match").val(""),$("#match").data("related",""),$("#match").val(a),$("#match").data("related",e),$(".search_result").hide(),t.preventDefault()}),$(".accordion-toggle").on("click",function(t){var e=$(this).attr("href");"true"==$(e).attr("aria-expanded")?($("a.accordion-toggle>i.fa").removeClass("fa-minus"),$("a.accordion-toggle>i.fa").addClass("fa-plus")):($("a.accordion-toggle>i.fa").removeClass("fa-plus"),$("a.accordion-toggle>i.fa").addClass("fa-minus"))}),$("body").on("click",".mine_delete_row",function(t){confirm("Вы уверены?")||t.preventDefault()}),$(".mine_delete_photo").on("click",function(t){t.preventDefault();var e=$(this);if(confirm("Вы точно уверены, что хотите удалить данную фотографию?")){var a=e.attr("data-id"),r=e.attr("data-table"),s=e.attr("data-column"),o=e.attr("data-path");$.post("/cp/delete_photo/",{table:r,id:a,column:s,path:o},function(t){response=JSON.parse(t);try{if(200!=response.status)throw new Error("status 500");e.closest(".mt-element-card").remove()}catch(t){console.log(t),alert("Во время удаления фотографии произошла ошибка")}})}}),$(".mine_delete_img_row").on("click",function(t){t.preventDefault();var e=$(this);if(confirm("Вы точно уверены, что хотите удалить данную фотографию?")){var a=e.attr("data-id"),r=e.attr("data-table");$.post("/cp/delete_img_row/",{table:r,id:a},function(t){try{if(response=JSON.parse(t),200!=response.status)throw new Error("status 500");e.closest(".mt-element-card").remove()}catch(t){console.log(t),alert("Во время удаления фотографии произошла ошибка")}})}}),$(".mine_clear_file").on("click",function(t){t.preventDefault();var e=$(this);if(confirm("Вы точно уверены, что хотите удалить данный файл?")){var a=e.attr("data-id"),r=e.attr("data-table"),s=e.attr("data-lang");$.post("/cp/delete_file/",{table:r,lang:s,id:a},function(t){try{if(response=JSON.parse(t),200!=response.status)throw new Error("status 500");e.closest(".mt-element-card").remove()}catch(t){console.log(t),alert("Во время удаления файла произошла ошибка")}})}}),$(".mine_datepicker").datepicker({format:"dd.mm.yyyy"}),t.init(),$(".multi_select").multiSelect({selectableHeader:"<input type='text' class='form-control' autocomplete='off' placeholder='Search'>",selectionHeader:"<input type='text' class='form-control' autocomplete='off' placeholder='Search'>",afterInit:function(t){var e=this,a=e.$selectableUl.prev(),r=e.$selectionUl.prev(),s="#"+e.$container.attr("id")+" .ms-elem-selectable:not(.ms-selected)",o="#"+e.$container.attr("id")+" .ms-elem-selection.ms-selected";e.qs1=a.quicksearch(s).on("keydown",function(t){if(40===t.which)return e.$selectableUl.focus(),!1}),e.qs2=r.quicksearch(o).on("keydown",function(t){if(40==t.which)return e.$selectionUl.focus(),!1})},afterSelect:function(){this.qs1.cache(),this.qs2.cache()},afterDeselect:function(){this.qs1.cache(),this.qs2.cache()}})});